<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>智慧旅游管理与调度系统</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Microsoft YaHei', Arial, sans-serif;
      /*background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);*/
      background-image: url("wangbujianwang.jpg");
      background-size: cover;
      -webkit-background-size: cover;
      -moz-background-size: cover;
      -o-background-size: cover;
      min-height: 100vh;
      color: #e0e0e0;
      background-attachment: fixed;
    }

    .header {
      background: rgba(16, 42, 67, 0.7);
      backdrop-filter: blur(10px);
      color: white;
      padding: 1rem 2rem;
      box-shadow: 0 2px 20px rgba(0,0,0,0.3);
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .header h1 {
      font-size: 2rem;
      text-align: center;
      text-shadow: 0 0 10px rgba(79, 195, 247, 0.5);
      letter-spacing: 1px;
    }

    .container {
      max-width: 1400px;
      margin: 2rem auto;
      padding: 0 1rem;
    }

    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .card {
      background: rgba(30, 40, 50, 0.4);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 1.5rem;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255,255,255,0.1);
      transition: all 0.3s ease;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
      border-color: rgba(79, 195, 247, 0.3);
    }

    .card-header {
      display: flex;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid rgba(79, 195, 247, 0.3);
    }

    .card-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(45deg, #4fc3f7, #29b6f6);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 1rem;
      font-size: 1.2rem;
      color: white;
      box-shadow: 0 0 10px rgba(79, 195, 247, 0.5);
    }

    .card-title {
      font-size: 1.3rem;
      font-weight: bold;
      color: #ffffff;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      margin-top: 1rem;
    }

    .info-item {
      background: rgba(25, 35, 45, 0.5);
      padding: 1rem;
      border-radius: 8px;
      border-left: 4px solid #4fc3f7;
      transition: transform 0.3s ease;
    }

    .info-item:hover {
      transform: translateX(5px);
    }

    .info-label {
      font-size: 0.9rem;
      color: #b0bec5;
      margin-bottom: 0.3rem;
    }

    .info-value {
      font-size: 1.1rem;
      font-weight: bold;
      color: #ffffff;
    }

    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 0.5rem;
      box-shadow: 0 0 5px currentColor;
    }

    .status-normal { background-color: #4caf50; }
    .status-warning { background-color: #ff9800; }
    .status-danger { background-color: #f44336; }

    .map-container {
      height: 300px;
      background: rgba(25, 35, 45, 0.5);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #b0bec5;
      font-size: 1.1rem;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(79, 195, 247, 0.2);
    }

    .map-overlay {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(16, 42, 67, 0.8);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      font-size: 0.9rem;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255,255,255,0.1);
    }

    .emergency-panel {
      background: linear-gradient(135deg, rgba(231, 76, 60, 0.7), rgba(192, 57, 43, 0.7));
      color: white;
      border: 1px solid rgba(255, 100, 100, 0.3);
    }

    .emergency-panel .card-header {
      border-bottom-color: rgba(255, 255, 255, 0.3);
    }

    .emergency-panel .card-title {
      color: white;
    }

    .emergency-panel .info-item {
      background: rgba(192, 57, 43, 0.5);
      border-left-color: #ffeb3b;
    }

    .emergency-panel .info-label {
      color: #ffeb3b;
    }

    .emergency-panel .info-value {
      color: white;
    }

    .navigation-buttons {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin-top: 2rem;
    }

    .nav-button {
      display: inline-block;          /* 让 <a> 也能撑开尺寸 */
      text-align: center;
      text-decoration: none;          /* 去掉下划线 */
      line-height: 1.2;               /* 垂直居中 */
      background: linear-gradient(45deg, rgba(25, 118, 210, 0.7), rgba(21, 101, 192, 0.7));
      color: white;
      border: none;
      padding: 1.2rem;
      border-radius: 10px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    .nav-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(33, 150, 243, 0.4);
      background: linear-gradient(45deg,rgba(33, 150, 243, 0.8), rgba(25, 118, 210, 0.8));
    }

    .real-time-data{
      display: flex;
      justify-content: space-between;
      align-items: center;
      backgroud:rgba(25,35,45, 0.5);
      padding: 1rem;
      boader-radius: 8px;
      margin-top: 1rem;
      border: 1px solid rgba(79, 195, 247, 0.2);
    }

    .data-item{
      text-align: center;
    }

    .data-number {
      font-size: 2rem;
      font-weight: bold;
      color: #4fc3f7;
      text-shadow: 0 0 10px rgba(79, 195, 247, 0.5);
    }

    .data-label {
      font-size: 0.9rem;
      color: #b0bec5;
      margin-top: 0.3rem
    }

    @media (max-width: 768px) {
      .dashboard-grid {
        grid-template-columns: 1fr;
      }
      .navigation-buttons {
        grid-template-columns: repeat(2, 1fr);
      }
      .info-grid {
        grid-template-columns: 1fr;
      }
    }
    <img src="wangbujianwang.jpg" height="429" width="864"/><img src="wangbujianwang.jpg" height="429" width="864"/></style>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>


<body>
<div class="container">
  <div class="dashboard-grid">
    <!-- 景区基础信息 -->
    <div class="card">
      <div class="card-header">
        <div class="card-icon"></div>
        <div class="card-title">景区基础信息</div>
      </div>
      <div class="info-grid" id="attraction-info">
        <div class="info-item">
          <div class="info-label">景区名称</div>
          <div class="info-value" id="attraction-name">加载中...</div>
        </div>
        <div class="info-item">
          <div class="info-label">最大客流量</div>
          <div class="info-value" id="max-capacity">加载中...</div>
        </div>
        <div class="info-item">
          <div class="info-label">停车位总数</div>
          <div class="info-value" id="parking-total">加载中...</div>
        </div>
        <div class="info-item">
          <div class="info-label">当前游客数</div>
          <div class="info-value" id="current-capacity">加载中...</div>
        </div>
      </div>
    </div>

    <!-- 管理人员信息 -->
    <div class="card">
      <div class="card-header">
        <div class="card-icon"></div>
        <div class="card-title">景区管理人员</div>
      </div>
      <div class="info-grid" id="manager-info">
        <div class="info-item">
          <div class="info-label">管理人员</div>
          <div class="info-value" id="manager-name">加载中...</div>
        </div>
        <div class="info-item">
          <div class="info-label">联系电话</div>
          <div class="info-value" id="manager-phone">加载中...</div>
        </div>
        <div class="info-item">
          <div class="info-label">紧急联系人</div>
          <div class="info-value" id="emergency-person">加载中...</div>
        </div>
        <div class="info-item">
          <div class="info-label">紧急电话</div>
          <div class="info-value" id="emergency-phone">加载中...</div>
        </div>
      </div>
    </div>

    <!-- 实时数据监控 -->
    <div class="card">
      <div class="card-header">
        <div class="card-icon"></div>
        <div class="card-title">实时数据监控</div>
      </div>
      <div class="real-time-data">
        <div class="data-item">
          <div class="data-number" id = "tourist" >23,847</div>
          <div class="data-label">当前游客数量</div>
        </div>
      </div>


      <!--                    <div class="real-time-data" id="touristPanel">-->
      <!--                        <div class="data-item">-->
      <!--                            <div class="data-number" id="touristCount">&#45;&#45;</div>-->
      <!--                            <div class="data-label">当前游客数量</div>-->
      <!--                        </div>-->
      <!--                    </div>-->

      <!--                    <script>-->
      <!--                        // 后端接口（已换成你的地址）-->
      <!--                        const TOURIST_API = 'http://localhost:8080/Tourists/CurrentCapacity';-->

      <!--                        async function loadTourist() {-->
      <!--                            try {-->
      <!--                                const res = await fetch(TOURIST_API);-->
      <!--                                const data = await res.json();          // 假设返回 { CurrentCapacity: 23847 }-->
      <!--                                const count = data.CurrentCapacity ?? 0;-->
      <!--                                document.getElementById('touristCount').textContent = count.toLocaleString();-->
      <!--                            } catch (e) {-->
      <!--                                console.error('获取游客数量失败', e);-->
      <!--                                document.getElementById('touristCount').textContent = '加载失败';-->
      <!--                            }-->
      <!--                        }-->

      <!--                        // 首次加载 + 每 30 秒更新-->
      <!--                        loadTourist();-->
      <!--                        setInterval(loadTourist, 30000);-->
      <!--                    </script>-->
<!--      <div class="data-number">1,256</div>-->
<!--      <div class="data-label">空余停车位</div>-->

      <div class="real-time-data">
        <div class="data-item">
          <div class="data-number" id = "cars" >1,256</div>
          <div class="data-label">当前剩余停车位数量</div>
        </div>
      </div>


    </div>
  </div>
  <div style="margin-top: 1rem; padding: 0.8rem; background: rgba(25, 35, 45, 0.5); border-radius: 8px; text-align: center;">
    <span class="status-indicator status-warning"></span>
    <span style="color: #ffeb3b; font-weight: bold;">客流量接近预警值，请注意疏导</span>
  </div>
</div>

<!-- 景区电子地图 -->
<div class="card">
  <div class="card-header">
    <div class="card-icon"></div>
    <div class="card-title">景区电子地图</div>
  </div>
  <div class="map-container">
    <div id="map-loading">景区电子地图加载中...</div>
    <div class="map-overlay" id="map-location">
      当前位置：加载中...
    </div>
  </div>
  <div class="info-grid" style="margin-top: 1rem;">
    <div class="info-item">
      <div class="info-label">经度</div>
      <div class="info-value" id="longitude">加载中...</div>
    </div>
    <div class="info-item">
      <div class="info-label">纬度</div>
      <div class="info-value" id="latitude">加载中...</div>
    </div>
    <div class="info-item">
      <div class="info-label">地址</div>
      <div class="info-value" id="address">加载中...</div>
    </div>
    <div class="info-item">
      <div class="info-label">电子地图</div>
      <div class="info-value">
        <a href="#" id="map-url" target="_blank" style="color: #4fc3f7;">查看地图</a>
      </div>
    </div>
  </div>
</div>

<!-- 应急救援信息 -->
<div class="card emergency-panel">
  <div class="card-header">
    <div class="card-icon"></div>
    <div class="card-title">应急救援信息</div>
  </div>
  <div class="info-grid" id="emergency-info">
    <div class="info-item">
      <div class="info-label">紧急联系人</div>
      <div class="info-value" id="emergency-person-name">加载中...</div>
    </div>
    <div class="info-item">
      <div class="info-label">应急电话</div>
      <div class="info-value" id="emergency-phone-number">加载中...</div>
    </div>
    <div class="info-item">
      <div class="info-label">应急车辆数</div>
      <div class="info-value" id="emergency-vehicle-count">加载中...</div>
    </div>
    <div class="info-item">
      <div class="info-label">车辆信息</div>
      <div class="info-value" id="emergency-vehicle-info">加载中...</div>
    </div>
  </div>
</div>
<!-- 系统状态 -->
<div class="card">
  <div class="card-header">
    <div class="card-
icon">4</div>
    <div class="card-
title">系统运行状态</div>
  </div>
  <div class="info-grid">
    <div class="info-item">
      <div class="info-
label">服务器状态</div>
      <div class="info-
value">
<span
        class="status-indicator status-normal"></span>正常运行
      </div>
    </div>
    <div class="info-item">
      <div class="info-
label">数据更新</div>
      <div class="info-
value">实时同步</div>
    </div>
    <div class="info-item">
      <div class="info-
label">网络连接</div>
      <div class="info-
value">
<span
        class="status-indicator status-normal"></span>稳定
      </div>
    </div>
    <div class="info-item">
      <div class="info-
label">最后更新</div>
      <div class="infc
value">刚刚</div>
    </div>
  </div>
</div>
</div>
<!-- 导航按钮 -->
<div class="navigation-buttons">
  <!--                <button class="nav-button"-->
  <!--                        onclick="navigateTo('HotelManagement.html')">酒店管理</button>-->
  <a href="HotelManagement.html" class="nav-button">酒店管理</a>
  <!--                    <button class="nav-button"-->
  <!--                            onclick="navigateTo('traffic')">管理</button>-->
<!--  <a href="Departments%20and%20vechicies.html" class="nav-button">旅行社及车辆管控</a>-->
  <!--                        <button class="nav-button"-->
  <!--                                onclick="navigateTo('security')">'监控</button>-->
  <a href="Guides.html" class="nav-button">导游管理</a>
  <!--                            <button class="nav-button"-->
  <!--                                    onclick="navigateTo('analysis')">~1分析</button>-->
  <a href="CatiousSystem.html" class="nav-button">告警设定中心</a>
  <!--                                <button class="nav-button"onclick="navigateTo('emergency')">急响应</button>-->
  <a href="TouristsBack.html" class="nav-button">游客投诉中心</a>
  <!--                                    <button class="nav-button"-->
  <!--                                            onclick="navigateTo('settings')"> 系统设置</button>-->
  <a href="CompanyBelieve.html" class="nav-button">企业诚信档案管理</a>
</div> -
</div>
<script>
  // 导航函数
  function navigateTo(page) {
    console.log(`导航到: ${page}`);
  }

  const API_BASE = 'http://localhost:8080';
  
  // 从后端获取景区完整信息
  function loadAttractionData() {
    // 获取第一个景区（如果有多个，可以改为获取列表）
    $.ajax({
      type: "GET",
      url: API_BASE + "/tourist",
      dataType: "json",
      success: function(attractions) {
        console.log('获取到的景区列表:', attractions);
        if (attractions && attractions.length > 0) {
          const attraction = Array.isArray(attractions) ? attractions[0] : attractions;
          updateAttractionInfo(attraction);
        } else {
          // 如果没有数据，尝试获取ID为1的景区
          loadAttractionById(1);
        }
      },
      error: function(xhr, status, error) {
        console.error('获取景区列表失败:', error);
        // 尝试获取ID为1的景区
        loadAttractionById(1);
      }
    });
  }

  function loadAttractionById(id) {
    $.ajax({
      type: "GET",
      url: API_BASE + "/tourist/" + id,
      dataType: "json",
      success: function(attraction) {
        console.log('获取到的景区数据:', attraction);
        updateAttractionInfo(attraction);
      },
      error: function(xhr, status, error) {
        console.error('获取景区数据失败:', error);
        document.getElementById("tourist").innerHTML = '--';
        document.getElementById("cars").innerHTML = '--';
      }
    });
  }

  function updateAttractionInfo(attraction) {
    if (!attraction) return;
    
    console.log('更新景区信息，完整数据:', attraction);
    
    // 更新基础信息
    document.getElementById("attraction-name").textContent = attraction.name || attraction.Name || '未知';
    document.getElementById("max-capacity").textContent = (attraction.maxCapacity || 0).toLocaleString() + ' 人/天';
    document.getElementById("parking-total").textContent = (attraction.parkingTotal || 0).toLocaleString() + ' 个';
    document.getElementById("current-capacity").textContent = (attraction.currentCapacity || attraction.CurrentCapacity || 0).toLocaleString() + ' 人';
    
    // 更新管理人员信息
    document.getElementById("manager-name").textContent = attraction.managerName || '未设置';
    document.getElementById("manager-phone").textContent = attraction.managerPhone || '未设置';
    document.getElementById("emergency-person").textContent = attraction.emergencyPerson || '未设置';
    document.getElementById("emergency-phone").textContent = attraction.emergencyPhone || '未设置';
    
    // 更新地理位置信息
    const longitude = attraction.longitude || 0;
    const latitude = attraction.latitude || 0;
    document.getElementById("longitude").textContent = longitude ? longitude.toFixed(4) + '°E' : '未设置';
    document.getElementById("latitude").textContent = latitude ? latitude.toFixed(4) + '°N' : '未设置';
    document.getElementById("address").textContent = attraction.address || '未设置';
    
    if (attraction.electronicMapUrl) {
      const mapLink = document.getElementById("map-url");
      mapLink.href = attraction.electronicMapUrl;
      mapLink.textContent = '查看地图';
    }
    
    // 更新应急救援信息 - 确保所有字段都正确获取（兼容多种字段名格式）
    const emergencyPerson = attraction.emergencyPerson || attraction.EmergencyPerson || '未设置';
    const emergencyPhone = attraction.emergencyPhone || attraction.EmergencyPhone || '未设置';
    const emergencyVehicleCount = attraction.emergencyVehicleCount || attraction.EmergencyVehicleCount || 0;
    const emergencyVehicleInfo = attraction.emergencyVehicleInfo || attraction.EmergencyVehicleInfo || '未设置';
    
    console.log('应急救援信息:', {
      emergencyPerson: emergencyPerson,
      emergencyPhone: emergencyPhone,
      emergencyVehicleCount: emergencyVehicleCount,
      emergencyVehicleInfo: emergencyVehicleInfo,
      rawData: attraction
    });
    
    // 更新应急救援信息面板
    const emergencyPersonNameEl = document.getElementById("emergency-person-name");
    const emergencyPhoneNumberEl = document.getElementById("emergency-phone-number");
    const emergencyVehicleCountEl = document.getElementById("emergency-vehicle-count");
    const emergencyVehicleInfoEl = document.getElementById("emergency-vehicle-info");
    
    if (emergencyPersonNameEl) {
      emergencyPersonNameEl.textContent = emergencyPerson;
      console.log('已更新紧急联系人:', emergencyPerson);
    } else {
      console.error('找不到元素: emergency-person-name');
    }
    
    if (emergencyPhoneNumberEl) {
      emergencyPhoneNumberEl.textContent = emergencyPhone;
      console.log('已更新应急电话:', emergencyPhone);
    } else {
      console.error('找不到元素: emergency-phone-number');
    }
    
    if (emergencyVehicleCountEl) {
      emergencyVehicleCountEl.textContent = emergencyVehicleCount + ' 辆';
      console.log('已更新应急车辆数:', emergencyVehicleCount);
    } else {
      console.error('找不到元素: emergency-vehicle-count');
    }
    
    if (emergencyVehicleInfoEl) {
      emergencyVehicleInfoEl.textContent = emergencyVehicleInfo;
      console.log('已更新车辆信息:', emergencyVehicleInfo);
    } else {
      console.error('找不到元素: emergency-vehicle-info');
    }
    
    // 更新实时数据
    const currentCapacity = attraction.currentCapacity || attraction.CurrentCapacity || 0;
    document.getElementById("tourist").textContent = currentCapacity.toLocaleString();
    
    const parkingRemaining = attraction.parkingRemaining || 0;
    document.getElementById("cars").textContent = parkingRemaining.toLocaleString();
    
    // 更新地图位置显示
    if (attraction.address) {
      document.getElementById("map-location").textContent = '当前位置：' + attraction.address;
    }
    
    // 更新告警状态
    const maxCapacity = attraction.maxCapacity || 50000;
    const usageRate = maxCapacity > 0 ? (currentCapacity / maxCapacity) * 100 : 0;
    const warningDiv = document.querySelector('.status-indicator');
    if (warningDiv) {
      const warningText = warningDiv.nextElementSibling;
      if (usageRate > 80) {
        warningDiv.className = 'status-indicator status-danger';
        if (warningText) warningText.textContent = '客流量严重超载，请立即疏导';
      } else if (usageRate > 70) {
        warningDiv.className = 'status-indicator status-warning';
        if (warningText) warningText.textContent = '客流量接近预警值，请注意疏导';
      } else {
        warningDiv.className = 'status-indicator status-normal';
        if (warningText) warningText.textContent = '客流量正常';
      }
    }
  }

  // 页面加载完成后初始化
  document.addEventListener('DOMContentLoaded', function() {
    console.log('智慧旅游管理与调度系统已加载');
    
    // 加载景区数据
    loadAttractionData();
    
    // 定时刷新数据（每5秒）
    setInterval(loadAttractionData, 5000);
    
    // 添加交互效果
    const cards = document.querySelectorAll('.card');
    cards.forEach(card => {
      card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-5px)';
      });
      card.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0)';
      });
    });
  });


</script>
</body>
</html>